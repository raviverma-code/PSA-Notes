e##############################
What is Spring boot
################################

Spring Boot is an open-source Java-based framework used to create stand-alone applications quickly and easily with minimal configuration.


Spring Boot Stand-Alone Application:
-------------------------------------------
-> You just run a main() method like any regular Java program.
-> It includes an embedded server (e.g., Tomcat) in the application itself.
-> No need to install or configure any external server separately.



Example:
@SpringBootApplication
public class MyApp {
    public static void main(String[] args) {
        SpringApplication.run(MyApp.class, args);  // Starts embedded server
    }
}

When you run above program
	a. Starts up the embedded server.
	b. Deploys your app on it.
	c. Listens to HTTP requests (like a web server).

Note: Since Spring boot is stand alone application, we package the application as jar file


##########################
What is Spring MVC?
##########################
-> Spring MVC stands for Spring Model-View-Controller.
—> It's a web framework in the Spring used to build web applications using the MVC design pattern.

How Spring MVC Works:
--------------------------
a. User sends a request (/home) or from html form.
b. DispatcherServlet (front controller) catches the request.
c. Finds the matching controller method using annotations like @GetMapping.
d. Executes logic and prepares data (Model).
c. Returns a view.


Spring Boot Annotations
---------------------------
1. What is @RequestMapping?

a. It’s a Spring MVC annotation used to map HTTP requests to handler methods or classes in your controller.
b. It tells Spring which URL (path) a particular method or class should handle.


2. What is @RequestParam?

a. It’s an annotation used in controller method parameters.
b. It binds HTTP request parameters (query parameters or form data) to method arguments.
c. It extracts values from the URL or form and passes them into your controller method.

3. What is @Service?

a. @Service is a Spring stereotype annotation.
b. It marks a class as a Service component in the Service Layer of your application.
c. Spring will detect it during component scanning and create an instance (bean) of that class in the Spring IOC container
d. It makes your class eligible for dependency injection.


4. What is @Component?

a. @Component is a generic Spring annotation to mark a class as a Spring-managed bean.
b. When you annotate a class with @Component, Spring will detect it during component scanning and create an instance (bean) of that class in the Spring IOC container.
c. It makes your class eligible for dependency injection.

5. What is @Controller?

a. @Controller is a Spring MVC stereotype annotation used to mark a class as a web controller.
b. Acts as mediator layer in MVC Architecture 

6. What is Model?

a. It's part of the MVC (Model-View-Controller) pattern.
b. It allows the controller to send data (attributes) to the view.
c. The view can then access and display that data.
d. Model in Spring is an interface, not a class

7. What is ModelMap in Spring MVC?

a. ModelMap is a special object provided by Spring MVC to pass data from your controller to the view layer (like JSP, Thymeleaf, etc.).
b. It behaves like a Map (key-value pairs)


######################################
Example - Create JSP page inside /src/webapp/WEB-INF/views/ and call that from controller layer 
###################################
Step 1:
----------
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Register</title>
</head>
<body>
	<h2>Register here......</h2>
</body>
</html>
registration.jsp
--------------------------------------------------------------------------------
Step 2:
-------
spring.application.name=app

spring.mvc.view.prefix=/WEB-INF/views/
spring.mvc.view.suffix=.jsp
application.properties
-----------------------------------------------------------------------------------
Step 3: Add dependency
-----------
<dependency>
		    <groupId>org.apache.tomcat.embed</groupId>
		    <artifactId>tomcat-embed-jasper</artifactId>
</dependency>
------------------------------------------------------------------------------------
Step 4: Developer Controller Layer

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
public class EmployeeController {
	
	@RequestMapping("/view")
	public String viewRegisterEmp() {
		return "register";
	}

}
Note
-------------
Why do we use a Dialect in Spring Boot (Hibernate)?
The dialect tells Hibernate how to generate SQL optimized for a specific database (like MySQL, PostgreSQL, Oracle, etc.).
------------------------
######################################
Example - Submit data from .jsp file and read that in Controller layer
###################################

<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Register</title>
</head>
<body>
	<h2>Register here..</h2>
	<form action="saveReg" method="post">
		<pre>
			First Name <input type="text" name="firstName"/>
			Last Name <input type="text" name="lastName"/>
			Email Id <input type="text" name="email"/>
			Mobile <input type="text" name="mobile"/>
			<input type="submit" value="save"/>
		</pre>
	</form>
${msg}
</body>
</html>
registration.jsp
-----------------------------------------------------------------------------

package com.app.entity;
import jakarta.persistence.*;

@Entity
public class Employee {

	@Id
	@GeneratedValue(strategy = GenerationType.IDENTITY)
	private long id;
	
	@Column(name = "first_name", nullable = false)
	private String firstName;
	
	@Column(name = "last_name", nullable = false)
	private String lastName;
	
	@Column(name = "email", nullable = false,unique = true)
	private String email;
	
	@Column(name = "mobile", nullable = false, unique = true)
	private String mobile;

	public long getId() {
		return id;
	}

	public void setId(long id) {
		this.id = id;
	}

	public String getFirstName() {
		return firstName;
	}

	public void setFirstName(String firstName) {
		this.firstName = firstName;
	}

	public String getLastName() {
		return lastName;
	}

	public void setLastName(String lastName) {
		this.lastName = lastName;
	}

	public String getEmail() {
		return email;
	}

	public void setEmail(String email) {
		this.email = email;
	}

	public String getMobile() {
		return mobile;
	}

	public void setMobile(String mobile) {
		this.mobile = mobile;
	}
	
	
}
Employee.java ---- Entity Class
------------------------------------------------------------------

spring.application.name=app

spring.mvc.view.prefix=/WEB-INF/views/
spring.mvc.view.suffix=.jsp

spring.datasource.url=jdbc:mysql://localhost:3306/appdb
spring.datasource.username=root
spring.datasource.password=test

spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect

spring.jpa.hibernate.ddl-auto=update

spring.jpa.show-sql=true

Add application.properties files
----------------------------------------

package com.app.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

import com.app.entity.Employee;

@Controller
public class EmployeeController {

	//Handler Methods - http://localhost:8080/view
	@RequestMapping("/view")
	public String viewRegisterPage() {
		return "registration";//--> RequestDispatcher
	}
	
	@RequestMapping("/saveReg")
	public String getRegistrationData(Employee employee, Model model) {
		employeeService.saveEmployeeDetails(employee);
		model.addAttribute("msg", "Record is saved");
		return "registration";
	}
}
EmployeeController.java
---------------------------------------------------------
import org.springframework.data.jpa.repository.JpaRepository;

import com.app.entity.Employee;

public interface EmployeeRepository extends JpaRepository<Employee, Long> {

}
Repository Layer
----------------------------------
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.app.entity.Employee;
import com.app.repository.EmployeeRepository;

@Service
public class EmployeeService {
	
	@Autowired
	private EmployeeRepository employeeRepository;
	
	public void saveEmployeeDetails(Employee employee) {
		employeeRepository.save(employee);
	}

}
EmployeeService.java

_________________________________________
What is @ModelAttribute in Spring MVC?
@ModelAttribute is an annotation used in Spring MVC to bind form data or request parameters to Java objects
_______________________________________

#############################
Payload / DTO implementation in Spring boot
############################
Step 1: Modify registration.jsp

<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Register</title>
</head>
<body>
	<h2>Register here..</h2>
	<form action="saveReg" method="post">
		<pre>
			First Name <input type="text" name="firstName"/>
			Last Name <input type="text" name="lastName"/>
			Email Id <input type="text" name="email"/>
			Mobile <input type="text" name="mobile"/>
			City <input type="text" name="city"/>
			State <input type="text" name="state"/>
			Pincode <input type="text" name="pinCode"/>
			Address Line <input type="text" name="addressLine"/>
			<input type="submit" value="save"/>
		</pre>
	</form>
	${msg}
</body>
</html>

Step 2: Modify EmployeeController.java
@Controller
public class EmployeeController {
	
	@Autowired
	private EmployeeService employeeService;

	//Handler Methods - http://localhost:8080/view
	@RequestMapping("/view")
	public String viewRegisterPage() {
		return "registration";//--> RequestDispatcher
	}
	
//	@RequestMapping("/saveReg")
//	public String getRegistrationData(Employee employee, ModelMap model) {
//		employeeService.saveEmployeeDetails(employee);
//		model.addAttribute("msg", "Record is saved");
//		return "registration";
//	}
	
	@RequestMapping("/saveReg")
	public String getRegistrationData(@ModelAttribute EmployeeDto employeeDto, Model model) {
		employeeService.saveEmployeeDetails(employeeDto);
		model.addAttribute("msg", "Record is saved");
        return "registration";
	}
	
}
Step 3: Add Address Entity
---------------------------
package com.app.entity;

import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;

@Entity
public class Address {
	@Id
	@GeneratedValue(strategy = GenerationType.IDENTITY)
	private long id;
	private String city;
	private String state;
	private int pinCode;
	private String addressLine;
	public long getId() {
		return id;
	}
	public void setId(long id) {
		this.id = id;
	}
	public String getCity() {
		return city;
	}
	public void setCity(String city) {
		this.city = city;
	}
	public String getState() {
		return state;
	}
	public void setState(String state) {
		this.state = state;
	}
	public int getPinCode() {
		return pinCode;
	}
	public void setPinCode(int pinCode) {
		this.pinCode = pinCode;
	}
	public String getAddressLine() {
		return addressLine;
	}
	public void setAddressLine(String addressLine) {
		this.addressLine = addressLine;
	}
	
	
}

Step 4: Add Repository Layer - AddressRepository.java
-----------------------------

Step 5: Modify Service Layer - EmployeeService.java
--------------------------
@Service
public class EmployeeService {
	
	@Autowired
	private EmployeeRepository employeeRepository;
	
	@Autowired
	private AddressRepository addressRepository;
	
	public void saveEmployeeDetails(EmployeeDto employeeDto) {
		Employee emp = new Employee();
		BeanUtils.copyProperties(employeeDto,emp);//-->Copy Data From Dto to Entity
		employeeRepository.save(emp);
		
		Address address = new Address();
		BeanUtils.copyProperties(employeeDto,address);//-->Copy Data From Dto to Entity
		addressRepository.save(address);
	}

}

#############################
Read Data from form using @RequestParam Annotation
############################

Step 1: Create employee.jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Employee</title>
</head>
<body>
	<h2>Employee Registration</h2>
	<form action="saveRegistration" method="post">
		<pre>
			First Name <input type="text" name="firstName"/>
			Last Name <input type="text" name="lastName"/>
			Email Id <input type="text" name="emailId"/>
			Mobile <input type="text" name="mobile"/>
			<input type="submit" value="save"/>
		</pre>
	</form>
</body>
</html>

Step 2: Modify EmployeeController.java

@RequestMapping("/saveRegistration")
	public String getDataUsingRequestParam(
			 @RequestParam String firstName,
			 @RequestParam String lastName,
			 @RequestParam("emailId") String email,
			 @RequestParam String mobile
			) {
		
		employeeService.register(firstName,lastName,email,mobile);
		return "employee";
	}
	
	//Handler Methods - http://localhost:8080/viewRegistration
		@RequestMapping("/viewRegistration")
		public String viewRegister() {
			return "employee";//--> RequestDispatcher
		}
	

Step 3: Modify EmployeeService.java

public void register(String firstName, String lastName, String email, String mobile) {
		Employee emp = new Employee();
		emp.setFirstName(firstName);
		emp.setLastName(lastName);
		emp.setEmail(email);
		emp.setMobile(mobile);
		employeeRepository.save(emp);
		
}

#######################################
what is JSTL tags?
-> Using JSTL we can write java code in the form of tags inside JSP pages
-> This makes non java developer to embed java code inside JSP

Example:
<c:out value="hello"></c:out>
#######################################

Steps to configure JSTL in spring boot version 3.x
---------------------------------------------------

1. Modify and add the below mentioned dependency

          <packaging>war</packaging>

 	   <dependency>
	        <groupId>jakarta.servlet.jsp.jstl</groupId>
	        <artifactId>jakarta.servlet.jsp.jstl-api</artifactId>
	        <version>3.0.0</version>
	    </dependency>
	
	    <dependency>
	        <groupId>org.glassfish.web</groupId>
	        <artifactId>jakarta.servlet.jsp.jstl</artifactId>
	        <version>3.0.1</version>
	    </dependency>

		 <dependency>
		        <groupId>jakarta.servlet</groupId>
		        <artifactId>jakarta.servlet-api</artifactId>
		        <scope>provided</scope>
		 </dependency>

2. Modify your main spring boot class:

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

@SpringBootApplication
public class AppApplication extends SpringBootServletInitializer {

    public static void main(String[] args) {
        SpringApplication.run(AppApplication.class, args);
    }

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {
        return builder.sources(AppApplication.class);
    }
}

3. Add core tag lib inside .jsp page
<%@ taglib prefix="e" uri="http://java.sun.com/jsp/jstl/core" %>

4. develop employee.jsp and add the following code
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Employee</title>
</head>
<body>
	<h2>Employee Registration</h2>
	<c:out value="hello"></c:out>	
</body>
</html>
5. In your controller develop the following method
	//Handler Methods - http://localhost:8080/viewRegistration
		@RequestMapping("/viewRegistration")
		public String viewRegister() {
			return "employee";//--> RequestDispatcher
		}
###################
Adding Menu.jsp
######################

Step 1: create menu.jsp page as shown below inside /WEB-INF/views
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
</head>
<body>
	<a href="view">Register Employee</a>
	<a href="">List Employees</a>
</body>
</html>

Step 2: Include menu in registration.jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ include file="menu.jsp" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Register</title>
</head>
<body>
	<h2>Register here..</h2>
	<form action="saveReg" method="post">
		<pre>
			First Name <input type="text" name="firstName"/>
			Last Name <input type="text" name="lastName"/>
			Email Id <input type="text" name="email"/>
			Mobile <input type="text" name="mobile"/>
			City <input type="text" name="city"/>
			State <input type="text" name="state"/>
			Pincode <input type="text" name="pinCode"/>
			Address Line <input type="text" name="addressLine"/>
			<input type="submit" value="save"/>
		</pre>
	</form>
	${msg}
</body>
</html>

#############################
Read data and build html table using JSTL concept
###########################

Step 1: 
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
</head>
<body>
	<a href="view">Register Employee</a>
	<a href="listRegistrations">List Employees</a>
</body>
</html>

Step 2: EmployeeController.java

package com.app.controller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

import com.app.dto.EmployeeDto;
import com.app.entity.Employee;
import com.app.repository.AddressRepository;
import com.app.service.EmployeeService;


@Controller
public class EmployeeController {

    private final AddressRepository addressRepository;
	
	@Autowired
	private EmployeeService employeeService;

    EmployeeController(AddressRepository addressRepository) {
        this.addressRepository = addressRepository;
    }

	//Handler Methods - http://localhost:8080/view
	@RequestMapping("/view")
	public String viewRegisterPage() {
		return "registration";//--> RequestDispatcher
	}
	
//	@RequestMapping("/saveReg")
//	public String getRegistrationData(Employee employee, ModelMap model) {
//		employeeService.saveEmployeeDetails(employee);
//		model.addAttribute("msg", "Record is saved");
//		return "registration";
//	}
	
	@RequestMapping("/saveReg")
	public String getRegistrationData(@ModelAttribute EmployeeDto employeeDto, Model model) {
		try {
			employeeService.saveEmployeeDetails(employeeDto);
			model.addAttribute("msg", "Record is saved");
	        return "registration";
		} catch (Exception e) {
			model.addAttribute("msg", "Duplicate entry");
	        return "registration";
		}
	}
	
	@RequestMapping("/saveRegistration")
	public String getDataUsingRequestParam(
			 @RequestParam String firstName,
			 @RequestParam String lastName,
			 @RequestParam("emailId") String email,
			 @RequestParam String mobile
			) {
		
		employeeService.register(firstName,lastName,email,mobile);
		return "employee";
	}
	
	//Handler Methods - http://localhost:8080/viewRegistration
		@RequestMapping("/viewRegistration")
		public String viewRegister() {
			return "employee";//--> RequestDispatcher
		}
		

		//Handler Methods - http://localhost:8080/listRegistrations
			@RequestMapping("/listRegistrations")
			public String viewRegistrations(ModelMap model) {
				List<Employee> employees = employeeService.getRegistrations();
				model.addAttribute("employees",employees);
				return "list_registrations";//--> RequestDispatcher
			}
	
}

Step 3: Add method to fetch all data from db in service layer: EmployeeService.java
package com.app.service;

import java.util.List;

import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.app.dto.EmployeeDto;
import com.app.entity.Address;
import com.app.entity.Employee;
import com.app.repository.AddressRepository;
import com.app.repository.EmployeeRepository;

@Service
public class EmployeeService {
	
	@Autowired
	private EmployeeRepository employeeRepository;
	
	@Autowired
	private AddressRepository addressRepository;
	
	public void saveEmployeeDetails(EmployeeDto employeeDto) {
		Employee emp = new Employee();
		BeanUtils.copyProperties(employeeDto,emp);
		employeeRepository.save(emp);
		
		Address address = new Address();
		BeanUtils.copyProperties(employeeDto,address);
		addressRepository.save(address);
	}

	public void register(String firstName, String lastName, String email, String mobile) {
		Employee emp = new Employee();
		emp.setFirstName(firstName);
		emp.setLastName(lastName);
		emp.setEmail(email);
		emp.setMobile(mobile);
		employeeRepository.save(emp);
		
	}
	
	public List<Employee> getRegistrations() {
		List<Employee> employees = employeeRepository.findAll();
		return employees;
		
	}

}
Step 4: List all data in a table  - list_registrations.jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ include file="menu.jsp" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Employee</title>
</head>
<body>
	<h2>View Registrations</h2>
	
	<table>
		<tr>
			<th>
				First name
			</th>
			<th>
				Last name
			</th>
			<th>
				Email
			</th>
			<th>
				Mobile
			</th>
			<th>
				Delete
			</th>
		</tr>
		
		<c:forEach var="emp" items="${employees}">
		<tr>
			<td>
				${emp.firstName}
			</td>
			<td>
				${emp.lastName}
			</td>
			<td>
				${emp.email}
			</td>
			<td>
				${emp.mobile}
			</td>
			
		</tr>
		
		</c:forEach>
		
	
	</table>
	
</body>
</html>

############################################
Delete a employee registration
##########################################

Step 1: Modify list_registrations.jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ include file="menu.jsp" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Employee</title>
</head>
<body>
	<h2>View Registrations</h2>
	
	<table>
		<tr>
			<th>
				First name
			</th>
			<th>
				Last name
			</th>
			<th>
				Email
			</th>
			<th>
				Mobile
			</th>
			<th>
				Delete
			</th>
		</tr>
		
		<c:forEach var="emp" items="${employees}">
		<tr>
			<td>
				${emp.firstName}
			</td>
			<td>
				${emp.lastName}
			</td>
			<td>
				${emp.email}
			</td>
			<td>
				${emp.mobile}
			</td>
			<td>
				<a href="deleteRegistration?id=${emp.id}">delete</a>
			</td>
			
		</tr>
		
		</c:forEach>
		
	
	</table>
	
</body>
</html>

Step 2: Create handler method inside EmployeeController.java

			@RequestMapping("/deleteRegistration")
			public String deleteRegistrationById(@RequestParam long id, ModelMap model) {
				employeeService.deleteRegistrationById(id);
				
				List<Employee> employees = employeeService.getRegistrations();
				model.addAttribute("employees",employees);
				return "list_registrations";//--> RequestDispatcher
			}
Step 3: In service layer add the following method: EmployeeService.java
public void deleteRegistrationById(long id) {
		employeeRepository.deleteById(id);
	}

###############################
Update Employee Details
##############################
Step 1: Modify list_registrations.jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ include file="menu.jsp" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Employee</title>
</head>
<body>
	<h2>View Registrations</h2>
	
	<table>
		<tr>
			<th>
				First name
			</th>
			<th>
				Last name
			</th>
			<th>
				Email
			</th>
			<th>
				Mobile
			</th>
			<th>
				Delete
			</th>
		</tr>
		
		<c:forEach var="emp" items="${employees}">
		<tr>
			<td>
				${emp.firstName}
			</td>
			<td>
				${emp.lastName}
			</td>
			<td>
				${emp.email}
			</td>
			<td>
				${emp.mobile}
			</td>
			<td>
				<a href="deleteRegistration?id=${emp.id}">delete</a>
			</td>
			<td>
				<a href="getRegistrationById?id=${emp.id}">update</a>
			</td>
		</tr>
		
		</c:forEach>
		
	
	</table>
	
</body>
</html>

Step 2: Modify EmployeeController.java

			@RequestMapping("/getRegistrationById")
			public String getRegistrationById(@RequestParam long id, ModelMap model) {
				Employee employee = employeeService.getRegistrationById(id);
				model.addAttribute("employee",employee);
				return "update_registration";//--> RequestDispatcher
			}
Step 3: Modify Service layer - EmployeeService.java
public Employee getRegistrationById(long id) {
		Optional<Employee> opEmp = employeeRepository.findById(id);
		return opEmp.get();
	}
Step 4: Create update_registration.jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ include file="menu.jsp" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Register</title>
</head>
<body>
	<h2>Register here..</h2>
	<form action="updateReg" method="post">
		<pre>
		    <input type="hidden" name="id" value="${employee.id}"/>
			First Name <input type="text" name="firstName" value="${employee.firstName}"/>
			Last Name <input type="text" name="lastName" value="${employee.lastName}"/>
			Email Id <input type="text" name="email" value="${employee.email}"/>
			Mobile <input type="text" name="mobile" value="${employee.mobile}"/>
			<input type="submit" value="update"/>
		</pre>
	</form>
	${msg}
</body>
</html>


#################################
Update the Record Continutation
###########################

Step 1: update_registration.jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ include file="menu.jsp" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Register</title>
</head>
<body>
	<h2>Register here..</h2>
	<form action="updateReg" method="post">
		<pre>
		    <input type="hidden" name="id" value="${employee.id}"/>
			First Name <input type="text" name="firstName" value="${employee.firstName}"/>
			Last Name <input type="text" name="lastName" value="${employee.lastName}"/>
			Email Id <input type="text" name="email" value="${employee.email}"/>
			Mobile <input type="text" name="mobile" value="${employee.mobile}"/>
			<input type="submit" value="update"/>
		</pre>
	</form>
	${msg}
</body>
</html>

Step 2: Update EmployeeController.java
@RequestMapping("/updateReg")
			public String updateRegistrationById(@ModelAttribute EmployeeDto employeeDto, ModelMap model) {
				employeeService.updateRegistrationById(employeeDto);
				List<Employee> employees = employeeService.getRegistrations();
				model.addAttribute("employees",employees);
				return "list_registrations";//--> RequestDispatcher
			}
}

Step 3: Update  EmployeeService.jsp
public void updateRegistrationById(EmployeeDto employeeDto) {
		Employee emp = new Employee();
		BeanUtils.copyProperties(employeeDto, emp);
		employeeRepository.save(emp);
	}

##############################
Sending Emailer when new registration is created
###########################

Step 1: Add the dependency:
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-mail</artifactId>
		</dependency>
Step 2: modify application.properties file
#Gmail Setup
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=pankajsiracademy2035@gmail.com
spring.mail.password=wowl mwum obmr rodh

spring.mail.protocol=smtp
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com

Step 3: Modify EmployeeCOntroller.java
---------------------------------
	@Autowired
	private EmailSender emailSender;
--------------------------
	@RequestMapping("/saveReg")
	public String getRegistrationData(@ModelAttribute EmployeeDto employeeDto, Model model) {
		
			employeeService.saveEmployeeDetails(employeeDto);
			emailSender.sendEmail(employeeDto.getEmail(), "Test", "Registration done!!");
			model.addAttribute("msg", "Record is saved");
	        return "registration";
		
	}

Step 4: Create EmailSender Component
package com.app.controller.utils;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.mail.SimpleMailMessage;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.stereotype.Component;

@Component
public class EmailSender {
	
	@Autowired
	private JavaMailSender mailSender;
	
	public void sendEmail(String to, String subject, String message) {
		SimpleMailMessage sm = new SimpleMailMessage();
		sm.setTo(to);
		sm.setSubject(subject);
		sm.setText(message);
		mailSender.send(sm);
	}
}

What are web service/ API / Restful service?

1. Integration-Friendly
→ Helps integrate heterogeneous (different tech stacks) or homogeneous (same stack) applications seamlessly.

2. Accelerates Development
→ Reduces development time by enabling third-party integrations (e.g., payment gateways, social logins, SMS/email services).

3. Cross-Platform Scalability
→ Easily supports multiple front-end clients like Android, iOS, Web browsers, or even IoT devices via standard HTTP/JSON communication.

What is JSON (Javascript Object Notation)?
##########################################
-> Format: Key-Value pairs
-> Language-independent (used with Java, Python, JS, etc.)
-> Supports:
a. Strings
b. Numbers
c. Booleans
d. Arrays
e. Objects
f. null

Example 
##########

{
  "name": "John",
  "age": 30,
  "isEmployee": true,
  "skills": ["Java", "Spring Boot", "REST"],
  "address": {
    "city": "Bangalore",
    "pincode": 560001
  }
}

Types of web services
#####################
1. SOAP web services
-> Simple Object Access Protocol
-> Will exchange data between applications using XML
-> Difficult to implement

2. Restful webservices
-> Data exchange between application will be done using JSON (We can also use xml)
-> Easy to implement

Note: Spring boot makes restful webservice implementation easy

#############################
Example to Create Employee Record using Rest api
#############################

Step 1: Create APIResponse dto, to send response in standard format

public class APIResponse<T> {

	private String message;
	private int status;
	private T data;
	
	public String getMessage() {
		return message;
	}
	public void setMessage(String message) {
		this.message = message;
	}
	public int getStatus() {
		return status;
	}
	public void setStatus(int status) {
		this.status = status;
	}
	public T getData() {
		return data;
	}
	public void setData(T data) {
		this.data = data;
	}
	
}

Step 2: Create EmployeeControllerAPI class

package com.app.api;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.app.dto.APIResponse;
import com.app.dto.EmployeeDto;
import com.app.service.EmployeeService;

@RestController
@RequestMapping("/api/v1/employee")
public class EmployeeControllerAPI {
	// http://localhost:8080/api/v1/employee/add
	
	@Autowired
	private EmployeeService employeeService;
	
	@PostMapping("/add")
	public ResponseEntity<APIResponse<EmployeeDto>> createEmployeeRegistration(@RequestBody EmployeeDto employeeDto) {
		EmployeeDto dto = employeeService.saveEmployeeDetails(employeeDto);
		
		APIResponse<EmployeeDto> response = new APIResponse<>();
		response.setMessage("Employee Registered");
		response.setStatus(201);
		response.setData(dto);
		
		return new ResponseEntity<>(response, HttpStatus.CREATED);
	}
}

Step 3: Create EmployeeService.java

	@Autowired
	private EmployeeRepository employeeRepository;
	
	@Autowired
	private AddressRepository addressRepository;
	
	public EmployeeDto saveEmployeeDetails(EmployeeDto employeeDto) {
		Employee emp = new Employee();
		BeanUtils.copyProperties(employeeDto,emp);
		Employee employeeSaved = employeeRepository.save(emp);
		
		Address address = new Address();
		BeanUtils.copyProperties(employeeDto,address);
		Address addredSaved = addressRepository.save(address);
		
		EmployeeDto dto = new EmployeeDto();
		BeanUtils.copyProperties(employeeSaved, dto);
		BeanUtils.copyProperties(addredSaved, dto);
		
		return dto;
	}





###################
Definitions
###############
a. ResponseEntity helps us send both the required HTTP status code and response data (usually in JSON format).
b. @RequestBody is an annotation in Spring used to bind the HTTP request body (usually in JSON format) to a Java object.
c. @RestController It is used to create RESTful web services that return data in JSON format
d. @PostMapping is a Spring MVC annotation used to handle HTTP POST requests.
It is typically used when you want to submit or create new data, such as inserting a record into the database.
e. Status Code: 201 Created is an HTTP response status code indicating that a resource has been successfully created as a result of a POST request.

##########################
Delete API - Delete Employee by Id
#########################

Step 1:  http://localhost:8080/api/v1/employee/delete?id=4
Use above url with delete option in postman

Step 2: Create a method in EmployeeController.java

// http://localhost:8080/api/v1/employee/delete?id=3
	@DeleteMapping("/delete")
	public ResponseEntity<APIResponse<String>> deleteEmployeeById(
			@RequestParam long id
			){
		employeeService.deleteEmployeeById(id);
		APIResponse<String> response = new APIResponse<>();
		response.setMessage("Delete....");
		response.setStatus(200);
		response.setData("Emplyee is deleted");
		
		return new ResponseEntity<>(response, HttpStatus.OK);
	}

Step 4: Create Following method inside EmployeeService.java

public void deleteEmployeeById(long id) {
		employeeRepository.deleteById(id);
	}

#####################
Fetch all employees from database using API
###################
Step 1: http://localhost:8080/api/v1/employee
Use this url in postman with get option

Step 2:EmployeeCOntroller.java create following method

@GetMapping
	public ResponseEntity<APIResponse<List<Employee>>> fetchAllRegistrations(){
		List<Employee> employees = employeeService.getRegistrations();
		APIResponse<List<Employee>> response = new APIResponse<>();
		response.setMessage("Delete....");
		response.setStatus(200);
		response.setData(employees);
		
		return new ResponseEntity<>(response, HttpStatus.OK);
	}

Step 3: Create following method inside EmployeeService.java

public List<Employee> getRegistrations() {
		List<Employee> employees = employeeRepository.findAll();
		return employees;
		
	}

#########################################
Udpdate Employee API
################################

Step 1: http://localhost:8080/api/v1/employee
Use the above url with thew JSON mentioned below:
{
    "id":1,
    "firstName":"stallin",
    "lastName":"a",
    "email":"abc@gmail.com",
    "mobile":"9631215511"
}

Step 2: Create following method in EmployeeController.java
@PutMapping
	public ResponseEntity<APIResponse<String>> UpdateRegistrations(
				@RequestBody EmployeeDto dto
			){
		employeeService.updateRegistrationById(dto);
		
		APIResponse<String> response = new APIResponse<>();
		response.setMessage("Updated....");
		response.setStatus(200);
		response.setData("Employee Record is udpdated");
		
		return new ResponseEntity<>(response, HttpStatus.OK);
	}
Step 3: Create following method inside EmployeeService.java
public void updateRegistrationById(EmployeeDto employeeDto) {
		Employee emp = new Employee();
		BeanUtils.copyProperties(employeeDto, emp);
		employeeRepository.save(emp);
	}

####################################
Pagination & Sorting in Spring boot - JPARepository
###################################


Pagination
---------

Step 1: Use the mentioned url in postman with option get

//http://localhost:8080/api/v1/employee?pageSize=3

Step 2: Create following method inside EmployeeControllerAPI class
	@GetMapping
	public ResponseEntity<APIResponse<List<Employee>>> fetchAllRegistrations(
				@RequestParam(value = "pageNo",  defaultValue = "0", required = false) int pageNo,
				@RequestParam(value = "pageSize",  defaultValue = "5", required = false) int pageSize
			
			){
		List<Employee> employees = employeeService.getRegistrations(pageNo,pageSize);
		APIResponse<List<Employee>> response = new APIResponse<>();
		response.setMessage("Employee Records");
		response.setStatus(200);
		response.setData(employees);
		
		return new ResponseEntity<>(response, HttpStatus.OK);
	}
	

Step 3: Create a method inside EmployeeService.java
	
	public List<Employee> getRegistrations(int pageNo, int pageSize) {
		Pageable pageable = PageRequest.of(pageNo, pageSize);
		Page<Employee> page = employeeRepository.findAll(pageable);
		List<Employee> employees = page.getContent();
		return employees;
		
	}

#######################
Sorting 
###################
Step 1: Use the mentioned url in postman with option get
http://localhost:8080/api/v1/employee?pageNo=0&pageSize=5&sortBy=email&sortDir=desc

Step 2: Create a method inside EmployeeControllerApi class
@GetMapping
	public ResponseEntity<APIResponse<List<Employee>>> fetchAllRegistrations(
				@RequestParam(value = "pageNo",  defaultValue = "0", required = false) int pageNo,
				@RequestParam(value = "pageSize",  defaultValue = "5", required = false) int pageSize,
				@RequestParam(value = "sortBy",  defaultValue = "id", required = false) String sortBy,
				@RequestParam(value = "sortDir",  defaultValue = "asc", required = false) String sortDir
			){
		List<Employee> employees = employeeService.getRegistrations(pageNo,pageSize,sortBy,sortDir);
		APIResponse<List<Employee>> response = new APIResponse<>();
		response.setMessage("Employee Records");
		response.setStatus(200);
		response.setData(employees);
		
		return new ResponseEntity<>(response, HttpStatus.OK);
	}

Step 3: Create a method inside EmployeeService.java class
public List<Employee> getRegistrations(int pageNo, int pageSize, String sortBy, String sortDir) {
		Sort sort = null;

//Sort sort = null;
//		sort = sortDir.equalsIgnoreCase("asc")?Sort.by(Direction.ASC,sortBy):Sort.by(Direction.DESC,sortBy);
			
		if(sortDir.equalsIgnoreCase("asc")) {
			sort = Sort.by(Direction.ASC, sortBy);
		}else {
			sort = Sort.by(Direction.DESC, sortBy);
		}
		
		Pageable pageable = PageRequest.of(pageNo, pageSize,sort);
		Page<Employee> page = employeeRepository.findAll(pageable);
		List<Employee> employees = page.getContent();


public List<Employee> getRegistrations(int pageNo, int pageSize, String sortBy, String sortDir) {
		Sort sort = null;
		sort = sortDir.equalsIgnoreCase("asc")?Sort.by(Direction.ASC, sortBy):Sort.by(Direction.DESC, sortBy);
			
		Pageable pageable = PageRequest.of(pageNo, pageSize,sort);
		Page<Employee> page = employeeRepository.findAll(pageable);
		List<Employee> employees = page.getContent();
		
		System.out.println(page.getNumber());
		System.out.println(page.getSize());
		System.out.println(page.getTotalPages());
		System.out.println(page.getTotalElements());
		System.out.println(pageable.getPageNumber());
		System.out.println(pageable.getPageSize());
		
		return employees;
		
	}
		return employees;
		
	}

Note:


✅ page.getNumber()
What it returns: Current page number (0-based index).

Example: If you're on the first page, it returns 0.

✅ page.getSize()
What it returns: The size of the page — i.e., how many records per page were requested.

Example: If PageRequest.of(0, 10) → returns 10.

✅ page.getTotalPages()
What it returns: Total number of pages based on total elements and page size.

Example: If there are 50 elements and page size is 10 → returns 5.

✅ page.getTotalElements()
What it returns: Total number of records (rows) in the entire result set (not just the current page).

Example: 123, even if you're on a page showing just 10.

✅ pageable.getPageNumber()
What it returns: The page number in the Pageable request.

Same as page.getNumber() (they are effectively equal).

Why used separately? – You might use this before executing the query, as it's directly from the request.

✅ pageable.getPageSize()
What it returns: Page size from the Pageable request.

Same as page.getSize(), but again taken from the request object.

#####################################
Spring Validation - Validates Use inputs
####################################

Step 1: Add the following dependency
<dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-validation</artifactId>
</dependency>

Step 2: Create a dto with validation annotations
package com.app.dto;

import java.time.LocalDate;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.Future;
import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.Size;

public class UserRequestDTO {
	//@NotNull
	@NotBlank(message = "Name is mandatory")
	@Size(min = 2, message = "Atleast 2 characters to be given")
    private String name;

	@Email
    private String email;

	@Size(min=10, max = 10, message = "Mobile number should be 10 digit")
    private String mobile;

	@Future(message = "Appointment date must be in the future")
    private LocalDate appointmentDate;

	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public String getEmail() {
		return email;
	}

	public void setEmail(String email) {
		this.email = email;
	}

	public String getMobile() {
		return mobile;
	}

	public void setMobile(String mobile) {
		this.mobile = mobile;
	}

	public LocalDate getAppointmentDate() {
		return appointmentDate;
	}

	public void setAppointmentDate(LocalDate appointmentDate) {
		this.appointmentDate = appointmentDate;
	}
    
    
    
}

Step 3: Create Controller Layer
-------------------------------
package com.app.controller;

import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.app.dto.UserRequestDTO;

import jakarta.validation.Valid;

@RestController
@RequestMapping("/api/users")
public class UserController {

	//http://localhost:8080/api/users/register
	@PostMapping("/register")
    public ResponseEntity<String> registerUser(
    		@Valid @RequestBody UserRequestDTO userRequestDTO,
    		BindingResult result
    		){
		
				if(result.hasErrors()) {
					return new ResponseEntity<>(result.getFieldErrors().toString(), HttpStatus.INTERNAL_SERVER_ERROR);
				}
				return new ResponseEntity<>("User Saved",HttpStatus.CREATED);
		
	}
}

Step 4: Go postman perform testing
url - http://localhost:8080/api/users/register
JSON Sample:
{
  "name": "J",
  "email": "john",
  "mobile": "98765432",
  "appointmentDate": "2025-03-01"
}

###############################
Exception handling in Spring boot
############################

Step 1:  Create a method inside EmployeeControllerAPI

@GetMapping("/getReg")
	public ResponseEntity<APIResponse<Employee>> getRegById(
			@RequestParam long id
			) {
		Employee employee = employeeService.getRegistrationById(id);
		APIResponse<Employee> response = new APIResponse<>();
		response.setMessage("Employee Details");
		response.setStatus(200);
		response.setData(employee);
		
		return new ResponseEntity<>(response, HttpStatus.OK);
		
	}

Step 2: Create an Exception class ResourceNotFound
package com.app.exception;

public class ResourceNotFound extends RuntimeException {
	
	public ResourceNotFound(String msg) {
		super(msg);
	}
}

Step 3: Create GlobalExceptionHandler.java class (Use @ControllerAdvice)

package com.app.exception;

import java.util.Date;

import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.context.request.WebRequest;

import com.app.dto.ErrorDetails;

@ControllerAdvice
public class GlobalExceptionHandler {
	
	
	
	//Exception Handler Method acts like catch block
	
	@ExceptionHandler(ResourceNotFound.class)
	public ResponseEntity<ErrorDetails> handleResourceNotFound(
			ResourceNotFound r,
			WebRequest request
			){
		
		ErrorDetails errorDetails = new ErrorDetails(r.getMessage(), new Date(), request.getDescription(false));
		return  new ResponseEntity<>(errorDetails,HttpStatus.INTERNAL_SERVER_ERROR);
	}
	

}

Step 4: Update service layer EmployeeService.java
public Employee getRegistrationById(long id) {
		
		Employee employee = employeeRepository.findById(id).orElseThrow(
				  ()->new ResourceNotFound("Employee does not exist")
				);
		return employee;
	}

Step 5: Perform testing in postman
url - http://localhost:8080/api/v1/employee/getReg?id=100



